# 硬件需求说明

## 带宽
IM服务、音视频服务、媒体服务需要流量带宽

#### IM服务
在线用户心跳是3分钟至4.5分钟一次，每次心跳来回4个字节，因此即使很大数量的用户在线，心跳的流量也是可以忽略不计的。流量主要消耗在发送消息，用户信息同步等功能上。需要预估峰值发送消息数，平均每条消息的大小，接受的次数。假如有10W高活跃用户（比如企业办公，上班时间都在线)，最高考虑到有100人同时发送消息，消息平均发送到50人的群中，消息的大小平均是0.5K，那么峰值带宽就是0.5K * 100 * （1 + 49） = 2.5MB/S = 20mbps。
> 这个例子是个很极端的情况，上下行消息吞吐量达到了5000条/s，实际在非办公场景下，在线用户与总用户比重非常低，消息吞吐量会低非常多。
> 实际运行中可以根据流量的情况动态调节服务带宽

#### 音视频服务
音视频通话是采用p2p的，只有打洞失败时才会走中转消耗流量，实际大概有50%的情况是可以打洞失败需要走中转的，中转时视频每路带宽消耗140KBps，音频大概是20KBps。如果指标是同时支持10路视频通话，那么流量就是10*0.5*140 = 700KBps = 5.6Mbps。

#### 文件服务器
媒体消息都是先上传到文件服务器，然后发送链接到对方的，这就保证了消息的尺寸比较小，避免了IM服务的流量压力。使用七牛服务器上传下载的容量可以认为无限制。
